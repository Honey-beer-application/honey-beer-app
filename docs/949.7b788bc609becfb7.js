"use strict";(self.webpackChunkhoney_beer_app=self.webpackChunkhoney_beer_app||[]).push([[949],{2949:(Ue,Z,y)=>{y.r(Z),y.d(Z,{ScannerModule:()=>Pe});var X=y(4755),O=y(5861),c=y(5206),ae=y(7579);class R extends ae.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(o){const{hasError:e,_hasValue:i,_value:t,thrownError:r,isStopped:s,_isComplete:d}=this;e?o.error(r):(s||d)&&(i&&o.next(t),o.complete())}next(o){this.isStopped||(this._value=o,this._hasValue=!0)}complete(){const{_hasValue:o,_value:e,_isComplete:i}=this;i||(this._isComplete=!0,o&&super.next(e),super.complete())}}var $=y(1135);const ce=["video"],de=["canvas"],le=["resultsPanel"],P="assets/wasm/index.js",I="https://cdn.jsdelivr.net/npm/ngx-scanner-qrcode@1.5.8/wasm/index.js",J={audio:!1,video:!0},k={lineWidth:1,strokeStyle:"green",fillStyle:"#55f02880"},U={font:"15px serif",strokeStyle:"#fff0",fillStyle:"#ff0000"},E={src:"",fps:30,vibrate:300,decode:"utf-8",isBeep:!0,constraints:J,canvasStyles:[k,U]};var D=()=>"zbarWasm"in window;const h=(n,o,e)=>{e?n.error(e):n.next(o),n.complete()},B=(n=!1)=>{if(!1===n)return;const o=new Audio("data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");o.oncanplaythrough=()=>{const e=o.play();e&&e.catch(i=>{})}},K=(n,o,e,i)=>{let t,r,s=o.width,d=o.height,l=s/d,a=parseInt(getComputedStyle(o).width),p=parseInt(getComputedStyle(o).height),A=a/p;e.innerHTML="",l>A?(t=a/s,r=a/l/d):(r=p/d,t=p*l/s);for(let v=0;v<n.length;v++){const f=n[v];let g=document.createElement("canvas"),Q=g.getContext("2d",{willReadFrequently:!0}),_={},T=[],u=[],C=0,m=0,G=2===i.length&&i[1]?.font?.replace(/[^0-9]/g,"");G&&/[0-9]/g.test(G)&&(C=parseFloat(G),m=(t||1)*C,Number.isNaN(m)&&(m=C));const j=f.points;for(let S=0;S<j.length;S++){const M=j?.[S]?.x??0,V=j?.[S]?.y??0;_[`x${S+1}`]=M,_[`y${S+1}`]=V,T.push(M),u.push(V)}let H=Math.max(...T),b=Math.min(...T),Y=Math.max(...u),w=Math.min(...u);g.setAttribute("class","qrcode-polygon"),l>A?(g.style.top=w*r+.5*(p-a/l)+"px",g.style.left=b*t+"px",g.width=(H-b)*t,g.height=(Y-w)*t):(g.style.top=w*r+"px",g.style.left=b*t+.5*(a-p*l)+"px",g.width=(H-b)*r,g.height=(Y-w)*r);for(const S in i[0])Q[S]=i[0][S];const z=[];for(let S=0;S<T.length;S++)z.push((_[`x${S+1}`]-b)*r),z.push((_[`y${S+1}`]-w)*t);const N=z.slice(0);for(Q.beginPath(),Q.moveTo(N.shift(),N.shift());N.length;)Q.lineTo(N.shift(),N.shift());if(Q.closePath(),Q.fill(),Q.stroke(),C){const S=document.createElement("div");S.setAttribute("class","qrcode-tooltip-temp"),S.innerText=f.value,S.style.maxWidth=(s>window.innerWidth?.9*window.innerWidth:s)+"px",S.style.borderRadius=`clamp(1px, ${t*C-10}px, 3px)`,S.style.paddingBlock=`clamp(1px, ${t*C-10}px, 3px)`,S.style.paddingInline=`clamp(2.5px, ${t*C-6}px, 10px)`;const M=`<svg xmlns="http://www.w3.org/2000/svg" width="${m}" height="${m}" viewBox="0 0 512 512"><rect x="128" y="128" width="336" height="336" rx="57" ry="57"></rect><path d="M383.5,128l.5-24a56.16,56.16,0,0,0-56-56H112a64.19,64.19,0,0,0-64,64V328a56.16,56.16,0,0,0,56,56h24"></path></svg>`,V=(new DOMParser).parseFromString(M,"application/xml"),W=S.ownerDocument.importNode(V.documentElement,!0);W.style.marginLeft=`clamp(1px, ${t*C-10}px, 3px)`,S.appendChild(W),W.addEventListener("click",()=>window.navigator.clipboard.writeText(f.value)),S.addEventListener("click",()=>window.navigator.clipboard.writeText(f.value));const x=document.createElement("div");x.setAttribute("class","qrcode-tooltip"),x.appendChild(S),r=p/d,t=p*l/s,x.style.fontSize=t*C+"px",x.style.top=w*r+"px",x.style.left=b*t+.5*(a-p*l)+"px",x.style.width=(H-b)*r+"px",x.style.height=(Y-w)*r+"px";const F=document.createElement("span");F.innerText=f.value,F.style.top=w*r+-20*r+"px",F.style.left=b*t+.5*(a-p*l)+"px";const ke=i[1]?.font?.split(" ")?.[1];F.style.fontFamily=ke,F.style.fontSize=t*C+"px",F.style.color=i?.[1]?.fillStyle,e?.appendChild(x),e?.appendChild(F)}e?.appendChild(g)}},ee=(n,o)=>new Promise((e,i)=>n.toBlob(t=>e(t),o)),te=(n=[],o,e,i,t=new R)=>(ne(n,e,i).then(r=>{Promise.all(Object.assign([],n).map(s=>((n,o)=>{let e=o?.decode??E.decode,i=2===o?.canvasStyles?.length?o?.canvasStyles:[k,U],t=o?.isBeep??E.isBeep;return new Promise((r,s)=>{const d=new FileReader;d.onload=()=>{const l={name:n.name,file:n,url:URL.createObjectURL(n)},a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=(0,O.Z)(function*(){const p=document.createElement("canvas");p.width=a.naturalWidth||a.width,p.height=a.naturalHeight||a.height;const A=p.getContext("2d");A.drawImage(a,0,0,p.width,p.height);const v=A.getImageData(0,0,p.width,p.height);if(D()){const f=yield zbarWasm.scanImageData(v);if(f?.length){f.forEach(T=>T.value=T.decode(e?.toLocaleLowerCase())),((n,o,e)=>{let i=o.getContext("2d",{willReadFrequently:!0});for(let t=0;t<n.length;t++){const r=n[t];let s={},d=[],l=[],a=0,A=e[1]?.font?.split(" ")?.[0]?.replace(/[^0-9]/g,"");A&&/[0-9]/g.test(A)&&(a=parseFloat(A));const v=r.points;for(let u=0;u<v.length;u++){const C=v?.[u]?.x??0,m=v?.[u]?.y??0;s[`x${u+1}`]=C,s[`y${u+1}`]=m,d.push(C),l.push(m)}let f=Math.min(...d),g=Math.min(...l);const Q=()=>{for(const m in e[0])i[m]=e[0][m];const u=[];for(let m=0;m<d.length;m++)u.push(s[`x${m+1}`]),u.push(s[`y${m+1}`]);const C=u.slice(0);for(i.beginPath(),i.moveTo(C.shift(),C.shift());C.length;)i.lineTo(C.shift(),C.shift());i.closePath(),i.fill(),i.stroke()};let _=document.createElement("canvas");const T=()=>{const u=e[1]?.font?.split(" ")?.[1];_.height=o.height,_.width=o.width;let C=_.getContext("2d",{willReadFrequently:!0});C.font=a+"px "+u;for(const m in e[1])C[m]=e[1][m];Ae(C,r.value,f,g-5)};Q(),T(),i.drawImage(_,0,0)}})(f,p,i);const g=yield ee(p),Q=URL.createObjectURL(g);r(Object.assign({},l,{data:f,url:Q,canvas:p,file:(T=g,u=l.name,new File([T],u,{lastModified:(new Date).getTime(),type:T.type}))})),B(t)}else r(Object.assign({},l,{data:f,canvas:p}))}var T,u}),a.src=l.url},d.onerror=l=>s(l),d.readAsDataURL(n)})})(s,o))).then(s=>{h(t,s)}).catch(s=>h(t,null,s))}),t),Ae=(n,o,e,i)=>{let t=1.2*n.measureText("M").width,r=o.split("\n");for(var s=0;s<r.length;++s)n.fillText(r[s],e,i),n.strokeText(r[s],e,i),i+=t},ne=function(){var n=(0,O.Z)(function*(o=[],e=.5,i="image/jpeg"){if(!o.length||1===e)return o;const t=function(){var s=(0,O.Z)(function*(d){const l=yield createImageBitmap(d),a=document.createElement("canvas");a.width=l.width,a.height=l.height,a.getContext("2d").drawImage(l,0,0);const A=yield new Promise(v=>a.toBlob(v,i,e));return new File([A],d.name,{type:A.type})});return function(l){return s.apply(this,arguments)}}(),r=new DataTransfer;return yield(0,O.Z)(function*(){for(const s of o){if(!s.type.startsWith("image")){r.items.add(s);continue}const d=yield t(s);r.items.add(d)}})(),r.files});return function(){return n.apply(this,arguments)}}(),oe=n=>{Object.assign([],n.childNodes).forEach(o=>n.removeChild(o))},L=(n,o)=>{n.style.width=o.offsetWidth+"px",n.style.height=o.offsetHeight+"px"},ie=(n=300)=>{n&&fe()&&window?.navigator?.vibrate(n)},fe=()=>{const n=navigator.userAgent||navigator.vendor||window.opera;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(n)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(n.substr(0,4))||/^((?!chrome|android).)*safari/i.test(n))};let ye=(()=>{class n{loadFiles(e=[],i,t){const r=new R;return ne(e,i,t).then(s=>{Promise.all(Object.assign([],e).map(d=>this.readAsDataURL(d))).then(d=>h(r,d)).catch(d=>h(r,null,d))}),r}loadFilesToScan(e=[],i,t,r){return te(e,i,t,r)}readAsDataURL(e){return new Promise((i,t)=>{const r=new FileReader;r.onload=()=>{const s={name:e.name,file:e,url:URL.createObjectURL(e)};i(s)},r.onerror=s=>t(s),r.readAsDataURL(e)})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Te=(()=>{class n{constructor(e,i){this.renderer=e,this.elementRef=i,this.event=new c.vpe,this.src=E.src,this.fps=E.fps,this.vibrate=E.vibrate,this.decode=E.decode,this.isBeep=E.isBeep,this.config=E,this.constraints=E.constraints,this.canvasStyles=[k,U],this.isStart=!1,this.isPause=!1,this.isLoading=!1,this.isTorch=!1,this.data=new $.X([]),this.devices=new $.X([]),this.deviceIndexActive=0,this.dataForResize=[],this.ready=new R,this.STATUS={startON:()=>this.isStart=!0,pauseON:()=>this.isPause=!0,loadingON:()=>this.isLoading=!0,startOFF:()=>this.isStart=!1,pauseOFF:()=>this.isPause=!1,loadingOFF:()=>this.isLoading=!1,torchOFF:()=>this.isTorch=!1}}ngOnInit(){this.overrideConfig(),((n=new R,o)=>{let e=0;const i=(t=!1)=>{const r=()=>{let l;try{const a=()=>{clearTimeout(l),D()?setTimeout(()=>h(n,!0)):l=setTimeout(()=>a())};setTimeout(()=>a()),setTimeout(()=>clearTimeout(l),3e3)}catch{clearTimeout(l)}},s=document.querySelectorAll(`script[src="${I}"]`),d=document.querySelectorAll('script[src="https://cdn.jsdelivr.net/npm/ngx-scanner-qrcode@latest/wasm/index.js"]');if(s.length||d.length)r();else{const l=document.querySelectorAll(`script[src="${P}"]`);if(1===l.length)r();else if(l.forEach(a=>a.remove()),o){const a=o.createElement("script");o.setAttribute(a,"src",t?I:P),o.setAttribute(a,"type","text/javascript"),o.setAttribute(a,"async",""),o.appendChild(document.head,a),a.onload=()=>r(),a.onerror=()=>{e<2?(document.head.removeChild(a),i(!0)):h(n,!1,I)},e+=1}else{const a=document.createElement("script");a.setAttribute("src",t?I:P),a.setAttribute("type","text/javascript"),a.setAttribute("async",""),document.head.appendChild(a),a.onload=()=>r(),a.onerror=()=>{e<2?(document.head.removeChild(a),i(!0)):h(n,!1,I)},e+=1}}};return i(),n})(this.ready,this.renderer).subscribe(()=>{this.src&&this.loadImage(this.src),this.resize()})}start(e){const i=new R;return this.isStart?h(i,!1):this.safariWebRTC(i,e),i}stop(){this.STATUS.pauseOFF(),this.STATUS.startOFF(),this.STATUS.torchOFF(),this.STATUS.loadingOFF();const e=new R;try{clearTimeout(this.rAF_ID),this.video.nativeElement.srcObject.getTracks().forEach(i=>{i.stop(),h(e,!0)}),this.dataForResize=[],(n=>{n.getContext("2d",{willReadFrequently:!0}).clearRect(0,0,n.width,n.height)})(this.canvas.nativeElement),oe(this.resultsPanel.nativeElement)}catch(i){h(e,!1,i)}return e}play(){const e=new R;return this.isPause?(this.video.nativeElement.play(),this.STATUS.pauseOFF(),this.requestAnimationFrame(100),h(e,!0)):h(e,!1),e}pause(){const e=new R;return this.isStart?(clearTimeout(this.rAF_ID),this.video.nativeElement.pause(),this.STATUS.pauseON(),h(e,!0)):h(e,!1),e}playDevice(e,i=new R){const t=this.getConstraints();switch(!0){case"null"===e||"undefined"===e||!e:stop(),this.stop(),h(i,!1);break;case e&&(!this.isStart||!t||t.deviceId!==e):stop(),this.stop(),this.STATUS.loadingON(),this.deviceIndexActive=this.devices.value.findIndex(d=>d.deviceId===e);const s={...this.constraints,audio:!1,video:{deviceId:e,...this.constraints.video}};navigator.mediaDevices.getUserMedia(s).then(d=>{this.video.nativeElement.srcObject=d,this.video.nativeElement.onloadedmetadata=()=>{this.video.nativeElement.play(),this.requestAnimationFrame(),h(i,!0),this.STATUS.startON(),this.STATUS.loadingOFF()}}).catch(d=>{this.eventEmit(!1),h(i,!1,d),this.STATUS.startOFF(),this.STATUS.loadingOFF()});break;default:h(i,!1),this.STATUS.loadingOFF()}return i}loadImage(e){const i=new R;this.STATUS.startOFF(),this.STATUS.loadingON();const t=new Image;return t.setAttribute("crossOrigin","anonymous"),t.onload=()=>{D()&&this.drawImage(t,r=>{h(i,r),this.STATUS.startOFF(),this.STATUS.loadingOFF()})},t.src=e,i}torcher(){const e=this.applyConstraints({advanced:[{torch:this.isTorch}]});return e.subscribe(()=>!1,()=>this.isTorch=!this.isTorch),e}applyConstraints(e,i=0){var t=this;const r=new R;if(this.isStart){const s=this.video.nativeElement.srcObject;if(null===i&&void 0===i&&Number.isNaN(i))h(r,!1,"Please check again deviceIndex");else{const d=s.getVideoTracks()[i];new window.ImageCapture(d).getPhotoCapabilities().then((0,O.Z)(function*(){yield d.applyConstraints(e),L(t.video.nativeElement,t.canvas.nativeElement),h(r,!0)})).catch(a=>{switch(a?.name){case"NotFoundError":case"DevicesNotFoundError":h(r,!1,"Required track is missing");break;case"NotReadableError":case"TrackStartError":h(r,!1,"Webcam or mic are already in use");break;case"OverconstrainedError":case"ConstraintNotSatisfiedError":h(r,!1,"Constraints can not be satisfied by avb. devices");break;case"NotAllowedError":case"PermissionDeniedError":h(r,!1,"Permission denied in browser");break;case"TypeError":h(r,!1,"Empty constraints object");break;default:h(r,!1,a)}})}}else h(r,!1,"Please start the scanner");return r}getConstraints(e=0){return this.video.nativeElement.srcObject?.getVideoTracks()[e]?.getConstraints()}download(e=`ngx_scanner_qrcode_${Date.now()}.png`,i,t){var r=this;const s=new R;return(0,O.Z)(function*(){const l=((n,o)=>new File([n],o,{lastModified:(new Date).getTime(),type:n.type}))(yield ee(r.canvas.nativeElement),e);te([l],r.config,i,t,s).subscribe(a=>{a.forEach(p=>{if(p?.data?.length){const A=document.createElement("a");A.href=p.url,A.download=p.name,A.click(),A.remove()}})})})(),s}resize(){window.addEventListener("resize",()=>{K(this.dataForResize,this.canvas.nativeElement,this.resultsPanel.nativeElement,this.canvasStyles),L(this.video.nativeElement,this.canvas.nativeElement)})}overrideConfig(){this.config?.src&&(this.src=this.config.src),this.config?.fps&&(this.fps=this.config.fps),this.config?.vibrate&&(this.vibrate=this.config.vibrate),this.config?.decode&&(this.decode=this.config.decode),this.config?.isBeep&&(this.isBeep=this.config.isBeep),this.config?.constraints&&(this.constraints=((n,o,e)=>{if(o&&Object.keys(o[n]).length){for(const i in e){const t=JSON.parse(JSON.stringify({...o[n],[i]:e[i]}));o[n]=o[n].hasOwnProperty(i)?o[n]:t}return o[n]}return e})("constraints",this.config,J)),this.config?.canvasStyles&&2===this.config?.canvasStyles.length&&(this.canvasStyles=this.config.canvasStyles)}safariWebRTC(e,i){this.STATUS.startOFF(),this.STATUS.loadingON(),navigator.mediaDevices.getUserMedia(this.constraints).then(t=>{t.getTracks().forEach(r=>r.stop()),this.loadAllDevices(e,i)}).catch(t=>{h(e,!1,t),this.STATUS.startOFF(),this.STATUS.loadingOFF()})}loadAllDevices(e,i){navigator.mediaDevices.enumerateDevices().then(t=>{let r=t.filter(s=>"videoinput"==s.kind);this.devices.next(r),r?.length>0?(h(e,r),i?i(r):this.playDevice(r[0].deviceId)):(h(e,!1,"No camera detected."),this.STATUS.startOFF(),this.STATUS.loadingOFF())}).catch(t=>{h(e,!1,t),this.STATUS.startOFF(),this.STATUS.loadingOFF()})}drawImage(e,i=(()=>{})){var t=this;return(0,O.Z)(function*(){const r=t.canvas.nativeElement,s=r.getContext("2d",{willReadFrequently:!0});e instanceof HTMLImageElement&&(r.width=e.naturalWidth,r.height=e.naturalHeight,e.style.visibility="",t.video.nativeElement.style.visibility="hidden",t.renderer.setStyle(t.elementRef.nativeElement,"width",r.width+"px"),t.renderer.setStyle(t.elementRef.nativeElement,"maxWidth","100%"),t.renderer.setStyle(t.elementRef.nativeElement,"display","inline-block")),e instanceof HTMLVideoElement&&(r.width=e.videoWidth,r.height=e.videoHeight,e.style.visibility="",t.canvas.nativeElement.style.visibility="hidden"),L(t.video.nativeElement,r),s.clearRect(0,0,r.width,r.height),s.drawImage(e,0,0,r.width,r.height);const d=s.getImageData(0,0,r.width,r.height),l=yield zbarWasm.scanImageData(d);if(l?.length){l.forEach(p=>p.value=p.decode(t.decode?.toLocaleLowerCase())),K(l,Object.freeze(t.canvas.nativeElement),t.resultsPanel.nativeElement,t.canvasStyles);const a=()=>{t.eventEmit(l),t.dataForResize=l};e instanceof HTMLImageElement&&(i(!0),a(),ie(t.vibrate),B(t.isBeep)),e instanceof HTMLVideoElement&&(a(),ie(t.vibrate),B(t.isBeep))}else i(!1),oe(t.resultsPanel.nativeElement),t.dataForResize=[]})()}eventEmit(e=!1){!1!==e&&this.data.next(e||[]),!1!==e&&this.event.emit(e||[])}requestAnimationFrame(e=0){try{clearTimeout(this.rAF_ID),this.rAF_ID=setTimeout(()=>{this.video.nativeElement.readyState===this.video.nativeElement.HAVE_ENOUGH_DATA&&(e=0,D()&&this.drawImage(this.video.nativeElement),this.isStart&&!this.isPause&&this.requestAnimationFrame(e))},e||this.fps)}catch{clearTimeout(this.rAF_ID)}}get isReady(){return this.ready}ngOnDestroy(){this.pause()}}return n.\u0275fac=function(e){return new(e||n)(c.Y36(c.Qsj),c.Y36(c.SBq))},n.\u0275cmp=c.Xpm({type:n,selectors:[["ngx-scanner-qrcode"]],viewQuery:function(e,i){if(1&e&&(c.Gf(ce,5),c.Gf(de,5),c.Gf(le,5)),2&e){let t;c.iGM(t=c.CRH())&&(i.video=t.first),c.iGM(t=c.CRH())&&(i.canvas=t.first),c.iGM(t=c.CRH())&&(i.resultsPanel=t.first)}},hostAttrs:[1,"ngx-scanner-qrcode"],inputs:{src:"src",fps:"fps",vibrate:"vibrate",decode:"decode",isBeep:"isBeep",config:"config",constraints:"constraints",canvasStyles:"canvasStyles"},outputs:{event:"event"},exportAs:["scanner"],decls:6,vars:0,consts:[[1,"origin-overlay"],["resultsPanel",""],[1,"origin-canvas"],["canvas",""],["playsinline","",1,"origin-video"],["video",""]],template:function(e,i){1&e&&c._UZ(0,"div",0,1)(2,"canvas",2,3)(4,"video",4,5)},styles:[".ngx-scanner-qrcode{display:block;position:relative}.origin-overlay{width:100%;position:absolute}.origin-overlay span{z-index:2;text-align:left;position:absolute}.origin-overlay .qrcode-polygon{z-index:1;position:absolute}.origin-canvas{width:100%;position:absolute}.origin-video{width:100%;background-color:#262626}.qrcode-tooltip{z-index:3;position:absolute}.qrcode-tooltip:hover .qrcode-tooltip-temp{display:block;position:absolute;cursor:copy}.qrcode-tooltip:hover .qrcode-tooltip-temp:active{color:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp{bottom:0;left:50%;color:#fff;text-align:left;display:none;width:max-content;word-wrap:break-word;transform:translate(-50%);transform-style:preserve-3d;background-color:#000000d0;box-shadow:1px 1px 20px #000000e0}.qrcode-tooltip .qrcode-tooltip-temp svg{cursor:pointer}.qrcode-tooltip .qrcode-tooltip-temp svg rect{fill:none;stroke:#fff;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg path{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg:active rect{stroke:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp svg:active path{stroke:#afafaf}\n"],encapsulation:2}),n})(),_e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=c.oAB({type:n}),n.\u0275inj=c.cJS({providers:[ye]}),n})();var se=y(7179),Ee=y(727),be=y(7036);class we{get QRCodeId(){return this._QRCodeId}set QRCodeId(o){this._QRCodeId=o}get Code(){return this._Code}set Code(o){this._Code=o}get scannedBy(){return this._scannedBy}set scannedBy(o){this._scannedBy=o}constructor(){this._QRCodeId=0n,this._Code="",this._scannedBy=new be.Z}}var xe=y(3144);let Oe=(()=>{class n{constructor(e){this.httpClient=e}scanQRCode(e){return this.httpClient.post("https://localhost:7165/api/QRCode",{qrCodeId:Number(e.QRCodeId),code:e.Code,scannedBy:{customerId:Number(e.scannedBy.customerId),username:e.scannedBy.username,password:e.scannedBy.password,email:e.scannedBy.email,personalEmailInstance:{email:e.scannedBy.personalEmailInstance.email}}})}}return n.\u0275fac=function(e){return new(e||n)(c.LFG(xe.eN))},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Fe=(()=>{class n{constructor(e){this.qrCodeService=e}scanQRCode(e){return this.qrCodeService.scanQRCode(e)}}return n.\u0275fac=function(e){return new(e||n)(c.LFG(Oe))},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Ie=y(665);const Ne=["action"];function De(n,o){1&n&&(c.TgZ(0,"p"),c._uU(1,"\u231b Loading..."),c.qZA())}const Me=[{path:"",component:(()=>{class n{constructor(e,i){this.qrCodeController=e,this.customerController=i,this.qrCode=null,this.subs=new Ee.w0}ngOnDestroy(){this.subs.unsubscribe()}beginScanning(){this.action.start()}onEvent(e){if(null==this.qrCode){this.qrCode=e[0].value;let i=new we;i.Code=this.qrCode,this.subs.add(this.customerController.registeredCustomer.asObservable().subscribe(t=>i.scannedBy=t)),this.qrCodeController.scanQRCode(i).subscribe(t=>alert("QR code is successfully scanned."),t=>alert(JSON.stringify(t.error)))}}endScanning(){this.action.stop(),this.qrCode=null}}return n.\u0275fac=function(e){return new(e||n)(c.Y36(Fe),c.Y36(Ie.Z))},n.\u0275cmp=c.Xpm({type:n,selectors:[["app-scanner"]],viewQuery:function(e,i){if(1&e&&c.Gf(Ne,5),2&e){let t;c.iGM(t=c.CRH())&&(i.action=t.first)}},decls:6,vars:2,consts:[[1,"scannerPage"],["id","qrCodeScanner",3,"event"],["action","scanner"],[4,"ngIf"],[1,"qrCodeButton",3,"click"]],template:function(e,i){if(1&e){const t=c.EpF();c.TgZ(0,"div",0)(1,"ngx-scanner-qrcode",1,2),c.NdJ("event",function(s){return i.onEvent(s)}),c.qZA(),c.YNc(3,De,2,0,"p",3),c.TgZ(4,"button",4),c.NdJ("click",function(){c.CHM(t);const s=c.MAs(2);return c.KtG(s.isStart?i.endScanning():i.beginScanning())}),c._uU(5),c.qZA()()}if(2&e){const t=c.MAs(2);c.xp6(3),c.Q6J("ngIf",t.isLoading),c.xp6(2),c.Oqu(t.isStart?"Stop":"Start")}},dependencies:[X.O5,Te],styles:[".qrCodeButton[_ngcontent-%COMP%]{border-radius:50px;background-color:#ffffffb3;border:1px solid rgba(0,0,0,.2);margin-inline:auto;margin-top:50px;font-size:28px;font-family:Freizeit120;cursor:pointer;padding:10px 20px}#qrCodeScanner[_ngcontent-%COMP%]{display:flex}#qrCodeScanner[_ngcontent-%COMP%]   .origin-overlay[_ngcontent-%COMP%]{width:5px}#qrCodeScanner[_ngcontent-%COMP%]   .origin-canvas[_ngcontent-%COMP%]{position:relative!important}#qrCodeScanner[_ngcontent-%COMP%]   .origin-video[_ngcontent-%COMP%]{width:50%;display:flex}.scannerPage[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:50%;margin-top:50px;max-width:600px;margin-inline:auto;max-height:200px}"]}),n})()}];let Ve=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=c.oAB({type:n}),n.\u0275inj=c.cJS({imports:[se.Bz.forChild(Me),se.Bz]}),n})(),Pe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=c.oAB({type:n}),n.\u0275inj=c.cJS({imports:[X.ez,_e,Ve]}),n})()}}]);